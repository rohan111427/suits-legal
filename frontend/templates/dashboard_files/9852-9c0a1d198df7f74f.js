"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9852],{69852:(e,t,i)=>{i.r(t),i.d(t,{default:()=>eK});var s=i(74848),l=i(91703),n=i(19427),a=i(82058),r=i(96540),o=i(37318),d=i(73688),p=i(22913),c=i(47863),h=i(76835),u=i(3508),g=i(66247),x=i(94191),j=i(55451),m=i(12832),v=i(67528),b=i(49518);let y=r.forwardRef(function(e,t){return(0,s.jsx)(h.A,{direction:"down",ref:t,...e})}),A=e=>{let t=(0,o.wA)(),i=(0,o.d4)(e=>e.user.editorFontSize)||14,l=(0,o.d4)(e=>e.user.editorDisableAutoComplete)||!1;return(0,s.jsxs)(u.A,{fullWidth:!0,maxWidth:"sm",onClose:()=>{e.onClose()},TransitionComponent:y,open:e.open,children:[(0,s.jsxs)(a.Ay,{container:!0,style:{paddingLeft:20,paddingRight:20,marginTop:20},children:[(0,s.jsxs)(g.A,{variant:"h6",component:"h1",gutterBottom:!0,color:"secondary",children:[" ","Editor Settings"," "]}),(0,s.jsx)("br",{}),(0,s.jsx)(x.A,{}),(0,s.jsx)("br",{}),(0,s.jsx)(j.A,{id:"outlined-multiline-flexible",style:{padding:10},required:!0,size:"small",type:"number",margin:"normal",variant:"outlined",label:"Font Size (8-32)",fullWidth:!0,value:i,onChange:e=>t((0,b.HM)(e.target.value)),slotProps:{htmlInput:{min:"8",max:"32"}}}),(0,s.jsx)(m.A,{labelPlacement:"start",control:(0,s.jsx)(v.A,{checked:l,onChange:e=>t((0,b.h$)(e.target.checked)),name:"autoCompleteToggle",color:"primary"}),label:"Disable Code Autocomplete/ Suggestions"})]}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{})]})};var f=i(45931),C=i(2424),O=i(52064),w=i(39641),k=i(61818),S=i(77861),T=i(5556),I=i.n(T);i(87976);let F=r.forwardRef(function(e,t){return(0,s.jsx)(h.A,{direction:"down",ref:t,...e})});class R extends r.Component{render(){let{classes:e}=this.props,{onClose:t,selectedValue:i,...n}=this.props,{value:r}=this.state,o=[];return this.props.availableLanguages?this.props.availableLanguages.length:Object.values(d).filter(e=>e.active).length,["Programming","Web","Database","Tool"].map(e=>{o.push({languageType:e,languageTitle:"Tool"===e?"Tools":"".concat(e," languages"),languagesAvailable:this.languageOptionsByType(e.toLowerCase(),this.props.availableLanguages)})}),(0,s.jsx)(u.A,{fullWidth:!0,maxWidth:"md",onClose:this.handleClose,TransitionComponent:F,open:this.props.open,children:0===r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.Ay,{container:!0,direction:"row",justifyContent:"flex-end",alignItems:"flex-start",children:(0,s.jsx)(a.Ay,{item:!0,xs:12,md:4,children:(0,s.jsxs)(l.A,{className:"oc-card",sx:e=>({marginRight:e.spacing(4),display:"flex",alignItems:"center",marginTop:e.spacing(2),marginBottom:0}),elevation:0,children:[(0,s.jsx)(f.Ay,{size:"small",onChange:e=>this.setState({searchString:e.target.value}),value:this.state.searchString,sx:e=>({marginLeft:e.spacing(3),flex:1}),placeholder:"Search languages...",inputProps:{"aria-label":"Search languages"}}),this.state.searchString?(0,s.jsx)(C.A,{sx:{padding:"10px"},"aria-label":"search",onClick:e=>this.setState({searchString:""}),size:"large",children:(0,s.jsx)(w.A,{})}):(0,s.jsx)(C.A,{sx:{padding:"10px"},"aria-label":"search",size:"large",children:(0,s.jsx)(S.A,{})})]})})}),(0,s.jsxs)(a.Ay,{container:!0,style:{paddingLeft:20,paddingRight:20},children:[o.map(e=>(0,s.jsx)(a.Ay,{item:!0,container:!0,direction:"row",children:0!=e.languagesAvailable.length&&(0,s.jsxs)("div",{style:{width:"100%"},children:[(0,s.jsxs)(g.A,{variant:"h6",component:"h1",gutterBottom:!0,color:"secondary",children:[" ",e.languageTitle," "]}),(0,s.jsx)(x.A,{}),(0,s.jsx)(a.Ay,{container:!0,children:e.languagesAvailable.map(e=>{let t=d[e];return"home"!==this.props.source&&t.beta?null:t.properties&&t.properties.url?(0,s.jsx)(a.Ay,{item:!0,sm:6,md:3,lg:3,sx:{cursor:"pointer",padding:"5px",borderRadius:"5px","&:hover":{backgroundColor:e=>"dark"===e.palette.mode?e.palette.grey[800]:e.palette.grey[300]}},children:(0,s.jsx)("a",{href:t.properties.url,target:"_blank",children:(0,s.jsx)(g.A,{variant:"subtitle1",component:"h2",children:(0,s.jsxs)(O.A,{sx:{display:"flex",alignItems:"center"},children:[t.name,(0,s.jsx)(k.A,{})]})})})},e):(0,s.jsx)(a.Ay,{item:!0,sm:6,md:3,lg:3,sx:{cursor:"pointer",padding:"5px",borderRadius:"5px","&:hover":{backgroundColor:e=>"dark"===e.palette.mode?e.palette.grey[800]:e.palette.grey[300]}},onClick:t=>this.props.handleListItemClick(e),children:(0,s.jsx)("a",{children:(0,s.jsxs)(O.A,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(g.A,{variant:"subtitle1",component:"h2",color:"primary",children:t.name}),t.beta&&(0,s.jsx)(k.A,{fontSize:"small",className:"ml5",color:"primary"})]})})},e)})}),(0,s.jsx)("br",{})]})},e.languageType)),"home"===this.props.source&&!1]})]})})}constructor(...e){super(...e),this.state={value:0,searchString:""},this.handleChange=(e,t)=>{this.setState({value:t})},this.handleClose=()=>{this.props.onClose()},this.languageOptionsByType=(e,t)=>{let i="";return this.state.searchString&&(i=Object.keys(d).filter(e=>e.toLowerCase().includes(this.state.searchString.toLowerCase())||d[e].name.toLowerCase().includes(this.state.searchString.toLowerCase()))),(i||Object.keys(d)).filter(e=>d[e].active).filter(t=>d[t].languageType===e).filter(e=>!t||!!t.includes(e))}}}R.propTypes={onClose:I().func,selectedValue:I().string};var M=i(47432),U=i(63279);let L=e=>{let{codeObj:t}=e;return(0,s.jsx)("div",{style:{paddingTop:2,paddingRight:2,float:"right"},children:(0,s.jsxs)(g.A,{variant:"caption",gutterBottom:!0,children:[(0,s.jsxs)("span",{itemProp:"datePublished",dateTime:"".concat(new Date(t.updated).toISOString().split("T")[0]),children:["created ".concat((0,M.A)(new Date(t.created),{max:1,suffix:!0}))," "]}),t.user&&t.user.name&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:" by "}),(0,s.jsx)(U.Link,{route:"/users/".concat(t.user._id),children:(0,s.jsx)("span",{children:(0,s.jsx)("span",{itemProp:"author",itemScope:!0,itemType:"http://schema.org/Person",children:(0,s.jsx)("span",{itemProp:"name",children:"".concat(t.user.name)})})})})]})]})})};var z=i(66903),P=i(64543),E=i(55935),_=i(33650);let N=r.forwardRef(function(e,t){return(0,s.jsx)(h.A,{direction:"down",ref:t,...e})}),V=e=>{let{open:t,handleClose:i,codeObj:l,handleUpdate:n,visibility:a,token:r,handleSave:o}=e;return(0,s.jsxs)(u.A,{open:t,TransitionComponent:N,fullWidth:!0,maxWidth:"md",onClose:i,children:[(0,s.jsx)(z.A,{children:(0,s.jsxs)("div",{children:[(0,s.jsx)(j.A,{id:"outlined-name",label:"Name",style:{width:"100%"},margin:"normal",variant:"outlined",value:l.title,onChange:e=>n("title",e.target.value)}),(0,s.jsx)("br",{}),(0,s.jsx)(j.A,{id:"outlined-multiline-flexible",fullWidth:!0,label:"Description",multiline:!0,rows:"4",maxRows:"20",margin:"normal",variant:"outlined",value:l.description||"",onChange:e=>n("description",e.target.value)}),(0,s.jsx)("br",{}),(0,s.jsx)(j.A,{id:"outlined-tags",label:"Tags",margin:"normal",variant:"outlined",style:{width:"100%"},value:l.tags?l.tags.join(", "):"",onChange:e=>{let t=e.target.value;t?n("tags",t.split(",").map(e=>e.trim().toLowerCase())):n("tags",[])}}),!a&&r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)(_.A,{value:l.visibility||"public",onChange:e=>n("visibility",e)})]})]})}),(0,s.jsxs)(P.A,{children:[(0,s.jsx)(E.A,{variant:"outlined",size:"small",color:"secondary",onClick:i,children:"Close"}),"\xa0\xa0",(0,s.jsx)(E.A,{variant:"outlined",size:"small",color:"primary",onClick:e=>{o()},children:"Save"})]})]})},D=e=>{var t,i,n,r,o;let{codeObj:d}=e;return(0,s.jsx)(a.Ay,{container:!0,children:(0,s.jsx)(a.Ay,{item:!0,xs:12,children:(0,s.jsx)(l.A,{variant:"outlined",style:{padding:"8px",overflow:"auto",maxHeight:"calc(100vh - 110px)"},children:(0,s.jsxs)("pre",{children:[" ",(null==d?void 0:null===(i=d.properties)||void 0===i?void 0:null===(t=i.files)||void 0===t?void 0:t.length)>0?null==d?void 0:null===(o=d.properties)||void 0===o?void 0:null===(r=o.files)||void 0===r?void 0:null===(n=r[0])||void 0===n?void 0:n.content:""," "]})})})})};var W=i(15404),B=i(87516),H=i(26015),J=i(39015),Z=i(60373),G=i(11866),q=i(35820),Y=i(42907),K=i(4429),$=i(83e3),Q=i(35811),X=i(12515),ee=i(89775),et=i(68516),ei=i(65059),es=i(94967),el=i(87076),en=i(74298),ea=i(67310),er=i(70362);function eo(e){let[t,i]=(0,r.useState)("");(0,o.d4)(e=>e.user);let n=async()=>{t&&""!=t&&(e.sendMessage(t),i(""))};return(0,s.jsxs)(s.Fragment,{children:[!e.userToken&&(0,s.jsx)(en.A,{action:(0,s.jsx)(E.A,{color:"inherit",size:"small",onClick:()=>{window.open("/login","_blank")},children:"Login"}),severity:"warning",children:"Please login to interact with the AI"}),(0,s.jsxs)(O.A,{sx:{backgroundColor:e=>e.palette.background.default,display:"flex",alignItems:"center",padding:e=>e.spacing(1,2)},children:[(0,s.jsx)(l.A,{variant:"outlined",component:O.A,flexGrow:1,ml:2,p:1,children:(0,s.jsx)(ee.A,{disabled:!e.userToken,disableUnderline:!0,fullWidth:!0,value:t,onChange:e=>{e.persist(),i(e.target.value)},onKeyUp:e=>{13===e.keyCode&&n()},placeholder:"Leave a message"})}),(0,s.jsx)(Z.A,{title:"Send",children:(0,s.jsx)("span",{children:(0,s.jsx)(C.A,{color:"primary",disabled:!t,onClick:n,size:"large",children:(0,s.jsx)(et.A,{fontSize:"small",children:(0,s.jsx)(es.A,{})})})})})]})]})}let ed=e=>{let t=(0,o.wA)(),[i,l]=r.useState([]),[a,d]=(0,r.useState)(!1),{token:p,plan:h}=(0,o.d4)(e=>e.user),u=(0,r.useRef)(null);async function j(t){var s,n,a,r,o,d,h,u;if((null==t?void 0:t.length)>2e3)return alert("Message is too long. Please keep it under 2000 characters.");l(e=>[...e,{content:t,role:"user"}]);let{json:g,error:x,statusCode:j}=await (0,c.RA)("/api/ai",p,{module:"editor",usecase:"codeHelp",currentMessage:t,conversation:i,metadata:{language:null===(n=e.codeObj)||void 0===n?void 0:null===(s=n.properties)||void 0===s?void 0:s.language,files:null===(r=e.codeObj)||void 0===r?void 0:null===(a=r.properties)||void 0===a?void 0:a.files,stdin:null===(d=e.codeObj)||void 0===d?void 0:null===(o=d.properties)||void 0===o?void 0:o.stdin,stdout:null===(u=e.codeObj)||void 0===u?void 0:null===(h=u.properties)||void 0===h?void 0:h.stdout}});j<400&&g?(null==g?void 0:g.message)?l(e=>[...e,g.message]):(console.log("error:",g),alert("Something went wrong. Message:"+JSON.stringify(g))):(console.log("error:",x),alert("Error: "+x))}(0,r.useEffect)(()=>{u.current&&u.current.scrollIntoView({behavior:"smooth"})},[i]);let m=()=>{d(!1)},v=()=>{window.open("/pricing","_blank")};return(0,s.jsxs)(n.A,{children:[(0,s.jsx)(Z.A,{title:"AI Help",children:(0,s.jsx)("button",{onClick:()=>{d(!0),p&&!h&&t((0,b.D)(p))},style:{background:"#2ecc71",color:"white",border:"none",borderRadius:5,padding:4,marginRight:4,marginTop:3,cursor:"pointer"},children:(0,s.jsxs)("span",{style:{marginLeft:1,marginRight:4},children:[(0,s.jsx)("img",{src:"/static/images/work/ai4.png",alt:"AI",style:{width:12,height:12}})," "," AI "]})})}),(0,s.jsxs)(X.Ay,{anchor:"right",sx:{"& .MuiDrawer-paper":{width:500,maxWidth:"100%"}},ModalProps:{BackdropProps:{invisible:!0}},onClose:m,open:a,variant:"temporary",children:[(0,s.jsx)(O.A,{p:1,style:{paddingLeft:15},children:(0,s.jsxs)(O.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,s.jsx)(g.A,{variant:"h6",color:"textPrimary",children:"Editor AI"}),(0,s.jsxs)("div",{children:[!h&&(0,s.jsx)(E.A,{variant:"outlined",endIcon:(0,s.jsx)(el.A,{}),size:"small",color:"primary",onClick:v,disabled:!p,sx:{mr:2},children:"Upgrade"}),(0,s.jsx)(Z.A,{title:"Close AI Chat",children:(0,s.jsx)(C.A,{onClick:m,size:"large",children:(0,s.jsx)(ei.A,{})})})]})]})}),(0,s.jsx)(x.A,{}),(0,s.jsx)("div",{id:"scrollableDiv",style:{height:"calc(100vh - 40px)",overflow:"auto",display:"flex",flexDirection:"column-reverse"},children:(0,s.jsx)(O.A,{flexGrow:1,p:2,children:(0,s.jsxs)(ea.A,{dataLength:i.length,inverse:!1,style:{display:"flex",flexDirection:"column"},hasMore:!1,scrollableTarget:"scrollableDiv",children:[i.length>0&&i.map((e,t)=>{var i;return(0,s.jsxs)("div",{children:[(0,s.jsx)(er.A,{markdown:null==e?void 0:e.content}),(null==e?void 0:null===(i=e.content)||void 0===i?void 0:i.startsWith("You have reached the daily limit"))&&(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"1rem"},children:(0,s.jsx)(E.A,{size:"small",color:"primary",onClick:v,style:{paddingRight:"25px"},children:"Upgrade"})})]},t)}),(0,s.jsx)("div",{ref:u})]})})}),(0,s.jsx)(x.A,{}),(0,s.jsx)(eo,{sendMessage:j,userToken:p})]})]})};function ep(e){let[t,i]=(0,r.useState)("");(0,o.d4)(e=>e.user);let n=async()=>{t&&""!=t&&(e.sendMessage(t),i(""))};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(O.A,{sx:e=>({backgroundColor:e.palette.background.default,display:"flex",alignItems:"center",padding:e.spacing(1,2)}),children:[(0,s.jsx)(l.A,{variant:"outlined",component:O.A,flexGrow:1,ml:2,p:1,children:(0,s.jsx)(ee.A,{disableUnderline:!0,fullWidth:!0,value:t,onChange:e=>{e.persist(),i(e.target.value)},onKeyUp:e=>{13===e.keyCode&&n()},placeholder:"Leave a message"})}),(0,s.jsx)(Z.A,{title:"Send",children:(0,s.jsx)("span",{children:(0,s.jsx)(C.A,{color:"primary",disabled:!t,onClick:n,size:"large",children:(0,s.jsx)(et.A,{fontSize:"small",children:(0,s.jsx)(es.A,{})})})})})]})})}let ec=e=>{let[t,i]=r.useState([]),[l,a]=(0,r.useState)(!1),d=(0,o.d4)(e=>e.user.token);async function p(s){var l,n,a,r,o,p,h,u;console.log("sending message:",s),i(e=>[...e,{content:s,role:"user"}]);let{json:g,error:x,statusCode:j}=await (0,c.RA)("/api/ai",d,{module:"editor",usecase:"codeHelpEmbedded",currentMessage:s,conversation:t,metadata:{language:null===(n=e.codeObj)||void 0===n?void 0:null===(l=n.properties)||void 0===l?void 0:l.language,files:null===(r=e.codeObj)||void 0===r?void 0:null===(a=r.properties)||void 0===a?void 0:a.files,stdin:null===(p=e.codeObj)||void 0===p?void 0:null===(o=p.properties)||void 0===o?void 0:o.stdin,stdout:null===(u=e.codeObj)||void 0===u?void 0:null===(h=u.properties)||void 0===h?void 0:h.stdout}});j<400&&g?(null==g?void 0:g.message)?i(e=>[...e,g.message]):(console.log("error:",g),alert("Something went wrong. Message:"+JSON.stringify(g))):(console.log("error:",x),alert("Error: "+x))}(0,o.d4)(e=>e.user.orgs);let h=()=>{a(!1)};return(0,s.jsxs)(n.A,{children:[(0,s.jsx)(Z.A,{title:"AI Help",children:(0,s.jsx)("button",{onClick:()=>{a(!0)},style:{background:"#2ecc71",color:"white",border:"none",borderRadius:5,padding:4,marginRight:4,marginTop:3,cursor:"pointer"},children:(0,s.jsxs)("span",{style:{marginLeft:1,marginRight:4},children:[(0,s.jsx)("img",{src:"/static/images/work/ai4.png",alt:"AI",style:{width:12,height:12}})," "," AI "]})})}),(0,s.jsxs)(X.Ay,{sx:{"& .MuiDrawer-paper":{width:"500px",maxWidth:"100%"}},anchor:"right",ModalProps:{BackdropProps:{invisible:!0}},onClose:h,open:l,variant:"temporary",children:[(0,s.jsx)(O.A,{p:1,style:{paddingLeft:15},children:(0,s.jsxs)(O.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,s.jsx)(g.A,{variant:"h6",color:"textPrimary",children:"Ask AI"}),(0,s.jsx)(C.A,{onClick:h,size:"large",children:(0,s.jsx)(ei.A,{})})]})}),(0,s.jsx)(x.A,{}),(0,s.jsx)("div",{id:"scrollableDiv",style:{height:"calc(100vh - 40px)",overflow:"auto",display:"flex",flexDirection:"column-reverse"},children:(0,s.jsx)(O.A,{flexGrow:1,p:2,children:(0,s.jsx)(ea.A,{dataLength:t.length,inverse:!1,style:{display:"flex",flexDirection:"column"},hasMore:!1,scrollableTarget:"scrollableDiv",children:t.length>0&&t.map(e=>(0,s.jsx)("div",{children:(0,s.jsx)(er.A,{markdown:null==e?void 0:e.content})}))})})}),(0,s.jsx)(x.A,{}),(0,s.jsx)(ep,{sendMessage:p,userToken:d})]})]})};var eh=i(1294),eu=i(17319),eg=i(67330),ex=i(79219),ej=i(62373),em=i(46968),ev=i(27621);let eb=/^[a-z0-9_-]+$/,ey=e=>{let{codeObj:t}=e,[i,l]=(0,r.useState)(!1),[n,a]=(0,r.useState)(!1),[d,p]=(0,r.useState)(!1),[h,g]=(0,r.useState)(""),[x,m]=(0,r.useState)({slug:"",title:"",description:"",visibility:"public"}),[v,b]=(0,r.useState)({}),[y,A]=(0,r.useState)(null),[f,w]=(0,r.useState)(""),S=(0,o.d4)(e=>e.user.token),T=(0,o.d4)(e=>e.user.plan);(0,r.useEffect)(()=>{I()},[i,t]);let I=async()=>{if(i&&t&&t._id){p(!0),g("");try{let{statusCode:e,json:i,error:s}=await (0,c.ZM)("/api/deployments/getDeploymentBySourceId/".concat(t._id),S);200===e&&i&&i.slug?(m({slug:i.slug||"",title:i.title||"",description:i.description||"",visibility:i.visibility||"public"}),A(i._id)):(m({slug:"",title:"",description:"",visibility:"public"}),A(null))}catch(e){g("Failed to fetch deployment info.")}finally{p(!1)}}else i&&(m({slug:"",title:"",description:"",visibility:"public"}),A(null));g(""),w(""),b({})},F=()=>{let e={};return x.slug?x.slug.length<4?e.slug="App Id must be at least ".concat(4," characters"):x.slug.length>63?e.slug="App Id must be at most ".concat(63," characters"):eb.test(x.slug)||(e.slug="Only lowercase letters, numbers, _ and - allowed"):e.slug="App Id is required",x.title||(e.title="App Title is required"),e},R=e=>{let{name:t,value:i}=e.target;"slug"===t&&(i=i.replace(/[^a-z0-9_-]/g,"")),m({...x,[t]:i}),b({...v,[t]:void 0})},M=e=>{m({...x,visibility:e}),b({...v,visibility:void 0})},U=async()=>{let e=F();if(Object.keys(e).length){b(e);return}a(!0),g(""),w("");try{var i,s;let{statusCode:e,json:l}=await (0,c.ZM)("/api/deployments/isSlugAvailable/".concat(x.slug),S);if(200!==e||l&&!1===l.available){b(e=>({...e,slug:"Slug is not available. Please choose another."})),a(!1);return}let{statusCode:n,json:r,error:o}=await (0,c.RA)("/api/deployments",S,{...x,sourceId:t._id,_id:y,files:null==t?void 0:null===(i=t.properties)||void 0===i?void 0:i.files,source:"editor"});200===n&&"success"===r.status?(w("Deployment saved successfully!"),A(null==r?void 0:null===(s=r.doc)||void 0===s?void 0:s._id)):g(r&&r.message||o||"Failed to save deployment")}catch(e){g("Failed to save deployment")}finally{a(!1)}},L=!t||!t._id;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Z.A,{title:"Deploy this program",children:(0,s.jsx)(C.A,{size:"large",sx:{mr:1},onClick:()=>l(!0),children:(0,s.jsx)(ev.A,{color:"textSecondary"})})}),(0,s.jsxs)(u.A,{open:i,onClose:()=>l(!1),maxWidth:"sm",fullWidth:!0,children:[(0,s.jsx)(eu.A,{children:"Deploy Program"}),(0,s.jsx)(z.A,{dividers:!0,children:L?(0,s.jsx)(en.A,{severity:"warning",children:"Please change & run the code before deploy."}):d?(0,s.jsx)(O.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:100,children:(0,s.jsx)(eg.A,{})}):(0,s.jsxs)(O.A,{component:"form",noValidate:!0,autoComplete:"off",sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,s.jsx)(j.A,{label:"App Title",name:"title",value:x.title,onChange:R,error:!!v.title,helperText:v.title,required:!0,disabled:n}),(0,s.jsx)(j.A,{label:"App Description",name:"description",value:x.description,onChange:R,multiline:!0,minRows:2,maxRows:4,disabled:n}),(0,s.jsx)(j.A,{label:"App Id",name:"slug",value:x.slug,onChange:R,error:!!v.slug,helperText:v.slug||"App Id must be at least ".concat(4," characters. Only lowercase letters, numbers, _ and - allowed"),inputProps:{pattern:"[a-z0-9_-]+",maxLength:63},required:!0,disabled:n}),(0,s.jsx)(O.A,{sx:{minWidth:200},children:(0,s.jsxs)(ex.A,{variant:"outlined",style:{minWidth:200},children:[(0,s.jsx)(ej.A,{htmlFor:"visibility-selector",children:"Visibility"}),(0,s.jsxs)(em.A,{native:!0,value:x.visibility,onChange:e=>M(e.target.value),label:"Visibility",inputProps:{name:"visibility",id:"visibility-selector"},children:[(0,s.jsx)("option",{value:"public",children:"Public (Everyone)"}),(0,s.jsx)("option",{value:"unlisted",children:"Unlisted (People with the Link)"})]})]})}),"unlisted"===x.visibility&&!T&&(0,s.jsx)(en.A,{severity:"warning",action:(0,s.jsx)(E.A,{color:"inherit",size:"small",onClick:()=>window.open("/pricing","_blank"),children:"Upgrade"}),children:"Please upgrade your plan to use unlisted."}),h&&(0,s.jsx)(en.A,{severity:"error",children:h}),f&&(0,s.jsx)(en.A,{severity:"success",children:f})]})}),(0,s.jsxs)(P.A,{children:[y&&x.slug&&(0,s.jsx)(O.A,{flexGrow:1,display:"flex",justifyContent:"flex-start",children:(0,s.jsx)(E.A,{variant:"outlined",color:"primary",href:"https://".concat(x.slug,".onecompiler.app"),target:"_blank",rel:"noopener noreferrer",endIcon:(0,s.jsx)(k.A,{}),children:"View Your App"})}),(0,s.jsxs)(O.A,{display:"flex",gap:1,children:[(0,s.jsx)(E.A,{onClick:()=>l(!1),color:"primary",variant:"outlined",disabled:n,children:"Close"}),(0,s.jsx)(E.A,{onClick:U,color:"primary",variant:"contained",disabled:L||n||d||"unlisted"===x.visibility&&!T,children:n?(0,s.jsx)(eg.A,{size:24}):"Deploy"})]})]})]})]})},eA=e=>{var t,i;let{codeObj:l,embed:a,running:o,showAi:c,source:h,hideNew:u,handleNewClick:g,hideLanguageSelection:x,handleLanguageModelOpen:j,codeVsConsoleSwitchValue:m,hideRun:v,handleRunClick:b,hideEditorOptions:y,handleEditorSettingsOpen:A,handleClearOutput:f,handleCodeMetaEdit:w,fullscreen:k,switchFullscreen:S,handleCodeVsConsoleSwitch:T}=e,I=(0,Y.A)(),F=(0,K.A)(I.breakpoints.up("sm")),R=(0,K.A)(I.breakpoints.down("sm"));return(0,s.jsxs)(n.A,{children:["home"===h&&(null===(i=d[l.properties.language])||void 0===i?void 0:null===(t=i.properties)||void 0===t?void 0:t.enableDeployments)&&(0,s.jsx)(ey,{codeObj:l}),c&&(0,s.jsx)(ec,{codeObj:l}),"home"===h&&(0,s.jsx)(ed,{codeObj:l}),!0!==u&&F&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Z.A,{title:"Create a new ".concat(l.properties.language.toUpperCase()," program"),children:(0,s.jsx)(E.A,{color:"primary",size:"small",onClick:e=>g(l.properties.language),children:"New"})}),"\xa0\xa0\xa0"]}),!0!==x&&F&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(Z.A,{title:"Click to change the language",children:(0,s.jsxs)(E.A,{size:"small",variant:"contained",color:"primary",className:"mr10",onClick:e=>{j()},children:[l.properties.language," ",(0,s.jsx)(H.A,{})]})})}),R&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(O.A,{sx:e=>({display:"inline",marginRight:"10px",border:"1px solid #ccc",padding:"3.9px 5px",paddingBottom:"8px",borderRadius:"4px",background:"code"===m?"linear-gradient(to right, ".concat("dark"===e.palette.mode?e.palette.grey[700]:e.palette.grey[300]," 50%, transparent 50%)"):"linear-gradient(to left, ".concat("dark"===e.palette.mode?e.palette.grey[700]:e.palette.grey[300]," 50%, transparent 50%)")}),children:[(0,s.jsx)(E.A,{size:"small",sx:e=>({color:e.palette.text.secondary,borderRadius:0}),onClick:()=>T("code"),children:"Code"}),(0,s.jsx)(E.A,{size:"small",sx:e=>({color:e.palette.text.secondary,borderRadius:0}),style:{borderLeft:"1px solid #ccc"},onClick:()=>T("console"),children:"I/O"})]})}),!0!==v&&(0,s.jsx)(Z.A,{title:window.navigator.platform.match(/^Mac/)?"⌘ + return":"ctrl + enter",children:(0,s.jsxs)(E.A,{size:"small",variant:"contained",color:"secondary",className:"mr10",onClick:e=>b(),disabled:o,children:["Run ",(0,s.jsx)(eh.A,{})]})}),!0!==y&&(0,s.jsx)($.Ay,{variant:"popover",popupId:"more-options-popup-menu",children:e=>(0,s.jsxs)(r.Fragment,{children:[(0,s.jsx)(C.A,{"aria-label":"more-options",...(0,Q.cO)(e),size:"large",children:(0,s.jsx)(J.A,{})}),(0,s.jsxs)(G.A,{...(0,Q.NA)(e),children:[(0,s.jsx)(q.A,{onClick:()=>{e.close(),l.properties.files.map(e=>p.A.downloadEditorFile(e.name,e.content))},children:"Download"}),(0,s.jsx)(q.A,{onClick:()=>{e.close(),A()},children:"Editor Settings"}),!a&&(0,s.jsx)(q.A,{onClick:()=>{e.close(),f()},children:"Clear Output"}),!a&&(0,s.jsx)(q.A,{onClick:()=>{e.close(),w()},children:"Title & Visibility"}),!a&&(0,s.jsx)(q.A,{onClick:()=>{e.close(),window.open("/".concat(l.properties.language,"/wiki"),"_blank")},children:"How To (Wiki)"})]})]})}),S&&(0,s.jsx)(Z.A,{title:"Full Screen",children:(0,s.jsx)(C.A,{onClick:()=>S(l),size:"large",children:k?(0,s.jsx)(B.A,{}):(0,s.jsx)(W.A,{})})})]})};var ef=i(14953),eC=i.n(ef),eO=i(9027),ew=i(59783),ek=i(19085);let eS=e=>{var t,i,l,n,a;let r=(0,Y.A)(),{language:o,running:p,codeObj:c,hideStdin:h,handleInputUpdate:u}=e,g=(0,K.A)(r.breakpoints.up("lg"));return(0,s.jsxs)(s.Fragment,{children:[c&&(null===(t=d[null==c?void 0:null===(i=c.properties)||void 0===i?void 0:i.language])||void 0===t?void 0:t.languageType)==="web"&&(0,s.jsx)(O.A,{id:"resultBrowser",sx:{height:e.isMobile?"calc(100vh - 105px)":"100%"},children:(0,s.jsx)(ek.A,{running:p,codeObj:c,language:o})}),c&&(null===(l=d[null==c?void 0:null===(n=c.properties)||void 0===n?void 0:n.language])||void 0===l?void 0:l.languageType)!=="web"&&(0,s.jsx)(O.A,{sx:{height:e.isMobile?"calc(100vh - 105px)":"100%"},children:(0,s.jsxs)(eO.YZ,{direction:"vertical",children:[!0!==h&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(eO.Zk,{defaultSize:g?11:20,children:(0,s.jsx)(O.A,{sx:{height:"100%",overflow:"auto",display:"flex",flexDirection:"column"},children:(0,s.jsx)(j.A,{sx:e=>({height:"100%","& .MuiInputBase-root":{height:"100%",alignItems:"flex-start"},"& .MuiInputBase-input":{height:"100%",boxSizing:"border-box",padding:e.spacing(1),overflow:"auto"},"& .MuiOutlinedInput-notchedOutline":{borderWidth:"0px",borderColor:"transparent !important"}}),onChange:e=>u(e.target.value),value:(null==c?void 0:null===(a=c.properties)||void 0===a?void 0:a.stdin)||"",label:"STDIN",placeholder:"Input for the program ( Optional )",margin:"normal",variant:"outlined",fullWidth:!0,multiline:!0,slotProps:{inputLabel:{shrink:!0}}})})})}),(0,s.jsx)(eO.TW,{style:{height:p||c.properties.result?"1px":"5px",background:"dark"===r.palette.mode?r.palette.alternate.dark:r.palette.grey[100]}}),(0,s.jsxs)(eO.Zk,{children:[p&&(0,s.jsx)(ew.A,{}),(0,s.jsxs)(O.A,{sx:e=>({paddingLeft:e.spacing(1),overflow:"auto",maxHeight:"100%",borderTop:!p&&c.properties.result?c.properties.result.success?"1.5px solid ".concat(e.palette.success.light," !important"):"1px solid ".concat(e.palette.error.light," !important"):void 0}),children:[(0,s.jsx)("p",{style:{fontSize:"0.875rem"},children:"Output:"}),(0,s.jsx)(O.A,{children:(0,s.jsx)("pre",{style:{fontSize:"0.875rem",lineHeight:"1.43"},children:c.properties.result&&c.properties.result.output||"Click on RUN button to see the output"})})]})]})]},g)})]})};var eT=i(94598);let eI=eC()(()=>Promise.all([i.e(9518),i.e(3334),i.e(9624),i.e(7602)]).then(i.bind(i,67602)),{loadableGenerated:{webpack:()=>[67602]},ssr:!1}),eF=e=>{let{language:t,running:i,hideStdin:l,codeObj:n,isOwnCode:a,hideResult:r,handleUpdate:o,codeVsConsoleSwitchValue:p,handleRunClick:c,height:h,codeTabIndex:u,disableCopyPaste:g,editorReadOnly:x,readOnlyList:j,handleInputUpdate:m}=e,v=(0,Y.A)(),b=(0,K.A)(v.breakpoints.down("sm")),y=(0,eT.M)().theme;return(0,s.jsxs)(eO.YZ,{autoSaveId:"oc:editor",direction:"horizontal",children:[!(b&&"console"===p)&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(eO.Zk,{defaultSize:60,children:n.properties.files.length>u&&(0,s.jsx)(eI,{onRun:()=>{c()},height:h||"100%",value:n.properties.files[u].content,mode:d[n.properties.language].fileVsMode?d[n.properties.language].fileVsMode[n.properties.files[u].name.split(".").pop()]:d[n.properties.language].mode,theme:(null==y?void 0:y.startsWith("dark"))?"dark":d[n.properties.language].theme,elevation:0,disableCopyPaste:g,readOnly:x||j&&j.length>0&&j.includes(n.properties.files[u].name),onChange:e=>{let t=[...n.properties.files];t[u].content=e,o(t,a)}})})}),!0!==r&&!(b&&"code"===p)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eO.TW,{style:{width:5,background:"dark"===v.palette.mode?v.palette.alternate.dark:v.palette.grey[100],"&:hover":{background:"dark"===v.palette.mode?v.palette.grey[700]:v.palette.grey[300],transition:"background 0.1s"}}}),(0,s.jsx)(eO.Zk,{defaultSize:40,children:(0,s.jsx)(eS,{isMobile:b,language:t,running:i,codeObj:n,hideStdin:l,handleInputUpdate:m})})]})]})};var eR=i(39155),eM=i(37915),eU=i(87503),eL=i(59113),ez=i(52362),eP=i(13514);let eE=e=>{let{codeObj:t,token:i,isOwnCode:l,codeTabIndex:n,handleTabChange:a,handleUpdate:o,hideNewFileOption:c,readOnlyList:h,handleNewCodeId:g,handleAssestsOpen:x,embed:m}=e,[v,b]=r.useState(!1),[y,A]=r.useState(!1),[f,w]=r.useState(null),[k,S]=r.useState(""),[T,I]=r.useState(null),F=e=>{w(e),S(t.properties.files[e].name),b(!0)},R=()=>{b(!1),w(null),S("")},M=e=>{I(e),A(!0)},U=()=>{A(!1),I(null)};return(0,s.jsxs)(O.A,{style:{display:"flex",flexDirection:"row"},children:[(0,s.jsx)(eL.H,{}),(0,s.jsx)(eR.A,{indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto",value:n,onChange:(e,t)=>{a(t)},children:t.properties.files.map((e,i)=>(0,s.jsx)(eU.A,{label:e.name,handleEdit:d[t.properties.language].properties.filesEditable?()=>F(i):null,handleDelete:!c&&d[t.properties.language].properties.newFileOptions&&d[t.properties.language].properties.newFileOptions.length&&!((null==h?void 0:h.length)>0&&h.includes(e.name))?()=>M(e.name):null},e.name))}),p.A.canHaveNewFiles(t)&&!c&&(0,s.jsx)($.Ay,{variant:"popover",popupId:"new-file-menu",children:e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.A,{"aria-label":"more-options-add-file",size:"large",...(0,Q.cO)(e),children:(0,s.jsx)(ez.A,{})}),(0,s.jsx)(G.A,{...(0,Q.NA)(e),children:d[t.properties.language].properties.newFileOptions.map(i=>(0,s.jsx)(q.A,{onClick:()=>{e.close();let s=[...t.properties.files],n=p.A.createNewFileAndContent(t.properties.files,i);n&&(s.push({...n}),o(s,l,!1,!0))},children:i.helpText},i.helpText))})]})}),p.A.canHaveImageUpload(t)&&!m&&(0,s.jsx)(C.A,{size:"large","aria-label":"upload-image",onClick:()=>{if(!i){(0,eL.o)("Please login to upload images",{icon:"⚠️"});return}t._id||g(),x()},children:(0,s.jsx)(eP.A,{})}),(0,s.jsxs)(u.A,{open:v,onClose:R,maxWidth:"sm",fullWidth:!0,children:[(0,s.jsx)(eu.A,{children:"Rename File"}),(0,s.jsx)(z.A,{children:(0,s.jsx)(j.A,{autoFocus:!0,margin:"dense",label:"File Name",type:"text",fullWidth:!0,variant:"outlined",value:k,onChange:e=>S(e.target.value)})}),(0,s.jsxs)(P.A,{children:[(0,s.jsx)(E.A,{onClick:R,children:"Cancel"}),(0,s.jsx)(E.A,{onClick:()=>{if(k&&null!==f){let e=[...t.properties.files];e[f].name=k,o(e,l,!0)}R()},variant:"contained",color:"primary",children:"Rename"})]})]}),(0,s.jsxs)(u.A,{open:y,onClose:U,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,s.jsx)(eu.A,{id:"alert-dialog-title",children:"Delete File"}),(0,s.jsx)(z.A,{children:(0,s.jsxs)(eM.A,{id:"alert-dialog-description",children:['Are you sure you want to delete the file "',T,'"? This action cannot be undone.']})}),(0,s.jsxs)(P.A,{children:[(0,s.jsx)(E.A,{onClick:U,children:"Cancel"}),(0,s.jsx)(E.A,{onClick:()=>{if(T){let e=[...t.properties.files];o(e=e.filter(e=>e.name!==T),l)}U()},color:"error",autoFocus:!0,children:"Delete"})]})]})]})};var e_=i(785);let eN=e=>{let{codeObj:t,isOwnCode:i,handleClick:l}=e;return(0,s.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"},children:(0,s.jsxs)(g.A,{variant:"body1",component:"h1",itemProp:"headline",color:"primary",style:i?{}:{paddingBottom:3,paddingTop:3,lineHeight:1.5},children:[null==t?void 0:t.title,"\xa0",i&&(0,s.jsx)(C.A,{"aria-label":"Edit",color:"primary",onClick:l,style:{padding:6},size:"large",children:(0,s.jsx)(e_.A,{fontSize:"small"})})]})})};var eV=i(1771),eD=i(39990),eW=i(70258),eB=i(20044),eH=i(77568),eJ=i(78036),eZ=i(85617);let eG=r.forwardRef(function(e,t){return(0,s.jsx)(h.A,{direction:"down",ref:t,...e})}),eq=function(e){let{open:t,codeId:i,userId:l,handleClose:n,userToken:a}=e,[o,d]=(0,r.useState)({}),[p,h]=(0,r.useState)([]),[x,j]=(0,r.useState)(!1),[m,v]=(0,r.useState)(!1);(0,r.useEffect)(()=>{b()},[t]);let b=async()=>{if(!t)return;if(!a){j(!0);return}let{statusCode:e,json:i}=await (0,c.ZM)("/api/assets/".concat(l),a);200===e?(h(i),j(!0)):alert("Failed to fetch assets")},y=async e=>{if(!window.confirm("Are you sure you want to delete this asset? This action cannot be undone."))return;v(!0);let{statusCode:t,json:i,error:s}=await (0,c.wQ)("/api/assets/".concat(l,"/").concat(e),a);v(!1),200===t?(j(!1),b()):alert("Failed to delete asset. Error: "+s)},A=(e,t)=>{navigator.clipboard.writeText(t),d({...o,[e]:!0}),setTimeout(()=>{d({...o,[e]:!1})},1e3)},f=async(e,t)=>{console.log(e.target.files[0]),e.target.files[0].name;var s=new FormData;s.append("upload_file",e.target.files[0]),v(!0);let{statusCode:n,json:r,error:o}=await (0,c.zo)("/api/assets/upload/".concat(l,"/").concat(i),a,s);v(!1),200===n?(null==r?void 0:r.status)==="success"&&(null==r?void 0:r.url)&&(j(!1),b()):alert("Failed to upload file. Error: "+o)};return(0,s.jsxs)(u.A,{fullScreen:!0,fullWidth:!0,maxWidth:"xl",open:t,onClose:n,TransitionComponent:eG,children:[(0,s.jsx)(eu.A,{id:"form-dialog-title",children:"Upload & Manage Images (Beta)"}),(0,s.jsxs)(z.A,{dividers:!0,children:[(0,s.jsxs)("div",{style:{float:"right"},children:[(0,s.jsx)("input",{accept:"image/*",style:{display:"none"},id:"contained-button-file",type:"file",onChange:e=>f(e,"image")}),(0,s.jsx)("label",{htmlFor:"contained-button-file",children:(0,s.jsx)(E.A,{variant:"contained",color:"primary",component:"span",disabled:!l||!i,children:"Upload New"})})]}),!x&&(0,s.jsx)(g.A,{variant:"h6",children:"Loading..."}),x&&0===p.length&&(0,s.jsx)(g.A,{variant:"h6",children:"No assets found!"}),x&&p.length>0&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(eB.A,{style:{marginTop:50,border:"1px solid #dadce0"},children:(0,s.jsxs)(eV.A,{"aria-label":"simple table",children:[(0,s.jsx)(eH.A,{children:(0,s.jsxs)(eJ.A,{children:[(0,s.jsx)(eW.A,{children:"Preview"}),(0,s.jsx)(eW.A,{children:"URL"}),(0,s.jsx)(eW.A,{children:"Size"}),(0,s.jsx)(eW.A,{children:"Actions"})]})}),(0,s.jsx)(eD.A,{children:p.map((e,t)=>(0,s.jsxs)(eJ.A,{style:{borderTop:"1.5px solid #E0E0E0"},children:[(0,s.jsx)(eW.A,{children:(0,s.jsx)("img",{src:e.url,style:{width:"auto",maxHeight:"100px"}})}),(0,s.jsx)(eW.A,{children:e.url}),(0,s.jsxs)(eW.A,{children:[(e.size/1024).toFixed(2)," KB"]}),(0,s.jsxs)(eW.A,{children:[(0,s.jsx)(E.A,{color:"primary",variant:"outlined",size:"small",onClick:()=>A(e._id,e.url),children:o[e._id]?"Copied !":"Copy URL"}),(0,s.jsx)(E.A,{color:"secondary",variant:"outlined",size:"small",onClick:()=>y(e._id),style:{marginLeft:"5px"},children:"Delete"})]})]},e._id))})]})})}),m&&(0,s.jsx)(eZ.A,{open:m})]}),(0,s.jsx)(P.A,{children:(0,s.jsx)(Z.A,{title:"Close","aria-label":"close",children:(0,s.jsx)(E.A,{onClick:n,color:"primary",variant:"outlined",size:"large",children:"Close"})})})]})};class eY extends r.Component{async componentDidMount(){this.setState({isServer:!1}),this.props.preFill&&!0===this.props.preFill.listenToEvents&&window.addEventListener("message",this.handleEmbedEvent);try{var e;if(this.props.preFill&&this.props.preFill.preloadCodeIds&&this.props.preFill.preloadCodeIds[this.state.codeObj.properties.language]&&!this.state.codeObj._id&&!(null===(e=this.props.preFill.codeObj)||void 0===e?void 0:e._id)){let e=[...this.state.codeObj.properties.files];e[0].content="Loading, Please wait...",this.setState({editorReadOnly:!0,codeObj:{...this.state.codeObj,properties:{...this.state.codeObj.properties,files:e}}});let t=this.props.preFill.preloadCodeIds[this.state.codeObj.properties.language],i=await (0,c.Jt)("/api/posts/".concat(t),this.props.userToken);i?(i._id=null,i.user=null,this.props.visibility&&(i.visibility=this.props.visibility),this.setState({codeObj:{...this.state.codeObj,...i},editorReadOnly:!1}),!0===this.props.preFill.listenToEvents&&i.properties&&i.properties.stdin&&window.postMessage({eventType:"populateStdinBack",stdin:i.properties.stdin||""},"*")):this.setState({editorReadOnly:!1})}}catch(e){console.log("Error while preload code",e)}}componentWillUnmount(){window.removeEventListener("message",this.handleEmbedEvent,!1)}handleEmbedEvent(e){if(e.data&&e.data.eventType){if("triggerRun"===e.data.eventType)this.handleOnRunClick();else if("populateCode"===e.data.eventType){if(e.data.language&&e.data.files&&e.data.files.length>0){if(d[e.data.language]){let t=JSON.parse(JSON.stringify(d[e.data.language]));t.visibility=this.props.visibility||this.state.codeObj.visibility||"public",t.properties.files=[...e.data.files],e.data.stdin&&(t.properties.stdin=e.data.stdin),e.data.result&&(t.properties.result=e.data.result),this.setState({codeObj:t})}else console.log("Invalid language "+e.data.language)}else console.log("language & files are mandatory for populateCode event")}else"populateStdin"===e.data.eventType&&this.setState({codeObj:{...this.state.codeObj,properties:{...this.state.codeObj.properties,stdin:e.data.stdin||""}}},()=>{this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj)})}}isOwnCode(){return!!this.state.codeObj&&(!!this.state.codeObj.user&&!!this.props.loggedInUserObj&&!!this.props.loggedInUserObj._id&&this.state.codeObj.user._id===this.props.loggedInUserObj._id||!!this.state.codeObj.idToken)}render(){var e,t,i,r,o,d,p;let c=this.isOwnCode(),h=(0,s.jsx)(eE,{codeObj:this.state.codeObj,isOwnCode:c,codeTabIndex:this.state.codeTabIndex,handleTabChange:e=>this.setState({codeTabIndex:e}),handleUpdate:(e,t,i,s)=>this.handleUpdateCode(e,t,i,s),hideNewFileOption:this.props.preFill.hideNewFileOption,readOnlyList:this.props.preFill.readOnlyList,embed:this.props.embed,token:this.props.token,handleNewCodeId:this.createCodeId,handleAssestsOpen:()=>this.setState({imageUploadModelOpen:!0})}),u=(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(eA,{embed:this.props.embed,codeObj:this.state.codeObj,showAi:null===(e=this.props.preFill)||void 0===e?void 0:e.showAi,hideRun:null===(t=this.props.preFill)||void 0===t?void 0:t.hideRun,hideEditorOptions:null===(i=this.props.preFill)||void 0===i?void 0:i.hideEditorOptions,source:this.props.source,running:this.state.running,codeVsConsoleSwitchValue:this.state.codeVsConsoleSwitchValue||"code",hideNew:null===(r=this.props.preFill)||void 0===r?void 0:r.hideNew,hideLanguageSelection:null===(o=this.props.preFill)||void 0===o?void 0:o.hideLanguageSelection,handleNewClick:e=>this.updateLanguage(e),handleLanguageModelOpen:()=>this.setState({languageSelectionModelOpen:!0}),handleCodeVsConsoleSwitch:e=>this.setState({codeVsConsoleSwitchValue:e}),handleRunClick:this.handleOnRunClick,handleEditorSettingsOpen:()=>this.setState({editorSettingsModelOpen:!0}),handleClearOutput:()=>this.handleClearOutput(),handleCodeMetaEdit:()=>this.setState({editingModelOpen:!0}),fullscreen:this.props.fullscreen,switchFullscreen:this.props.switchFullscreen})});return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(l.A,{variant:"outlined",children:[this.state.isServer&&(0,s.jsx)(D,{codeObj:this.state.codeObj}),(0,s.jsxs)(n.A,{children:[(0,s.jsxs)(a.Ay,{container:!0,direction:"row",sx:{justifyContent:"space-between",alignItems:"center",display:{xs:"none",sm:"flex"},background:e=>"dark"===e.palette.mode?e.palette.alternate.dark:e.palette.grey[100]},children:[(0,s.jsx)(a.Ay,{item:!0,sx:{justifyContent:"space-between",alignItems:"center"},children:h}),(0,s.jsx)(a.Ay,{children:!(this.props.preFill&&!0===this.props.preFill.hideTitle)&&(0,s.jsx)(eN,{codeObj:this.state.codeObj,isOwnCode:c,handleClick:this.toggleEditingModel})}),(0,s.jsxs)(a.Ay,{item:!0,children:[" ",u," "]})]}),(0,s.jsxs)(a.Ay,{container:!0,direction:"column",sx:{display:{xs:"flex",sm:"none"},justifyContent:"space-between",alignItems:"center",background:e=>"dark"===e.palette.mode?e.palette.alternate.dark:e.palette.grey[100],paddingTop:e=>e.spacing(.5)},children:[(0,s.jsx)(a.Ay,{item:!0,xs:12,children:u}),"code"===this.state.codeVsConsoleSwitchValue&&(0,s.jsx)(a.Ay,{item:!0,xs:12,children:h})]}),(0,s.jsx)(eF,{language:this.props.language,running:this.state.running,hideStdin:(null===(d=this.props.preFill)||void 0===d?void 0:d.hideStdin)===!0,codeObj:this.state.codeObj,isOwnCode:c,codeVsConsoleSwitchValue:this.state.codeVsConsoleSwitchValue,handleRunClick:this.handleOnRunClick,height:this.props.height,codeTabIndex:this.state.codeTabIndex,disableCopyPaste:this.props.preFill.disableCopyPaste,editorReadOnly:this.state.editorReadOnly,readOnlyList:this.props.preFill.readOnlyList,handleUpdate:(e,t,i,s)=>this.handleUpdateCode(e,t,i,s),hideResult:null===(p=this.props.preFill)||void 0===p?void 0:p.hideResult,handleInputUpdate:e=>{this.setState({codeObj:{...this.state.codeObj,properties:{...this.state.codeObj.properties,stdin:e}}},()=>{this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj)})}})]}),(0,s.jsxs)("div",{children:[!this.props.fullscreen&&!this.props.embed&&this.state.codeObj&&this.state.codeObj.updated&&(0,s.jsx)(L,{codeObj:this.state.codeObj}),(0,s.jsx)(R,{source:this.props.source,isUserLoggedIn:!!this.props.token,availableLanguages:this.props.preFill?this.props.preFill.availableLanguages:null,handleListItemClick:e=>{this.setState({language:e,languageSelectionModelOpen:!1},()=>this.updateLanguage(e)),this.props.handleLanguageChange&&this.props.handleLanguageChange(e)},open:this.state.languageSelectionModelOpen,onClose:()=>{this.setState({languageSelectionModelOpen:!1})}}),(0,s.jsx)(eq,{codeId:this.state.codeObj._id,userId:this.props.loggedInUserObj._id,open:this.state.imageUploadModelOpen,handleClose:()=>this.setState({imageUploadModelOpen:!1}),userToken:this.props.token})]}),(0,s.jsx)(A,{open:this.state.editorSettingsModelOpen,onClose:()=>this.setState({editorSettingsModelOpen:!1})}),(0,s.jsx)(V,{open:this.state.editingModelOpen,handleClose:()=>this.setState({editingModelOpen:!1}),codeObj:this.state.codeObj,handleUpdate:(e,t)=>this.handleUpdateCodeMeta(e,t),handleSave:()=>{this.setState({editingModelOpen:!1}),this.handleOnRunClick(!1)},visibility:this.props.visibility,token:this.props.token})]})})}constructor(e){var t,i;super(e),this.createCodeId=()=>{this.state.creatingCodeId||this.setState({creatingCodeId:!0,codeObj:{...this.state.codeObj,_id:null,title:"forking...",user:null}},()=>{fetch("/api/getIdAndToken").then(e=>e.json()).then(e=>{let t=e.id,i=e.token,s={...this.state.codeObj,_id:t,title:t};this.props.loggedInUserObj&&this.props.loggedInUserObj._id?s.user={_id:this.props.loggedInUserObj._id}:s.idToken=i,this.setState({creatingCodeId:!1,codeObj:s,output:null},()=>{this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj)})})})},this.handleClearOutput=async()=>{if(this.state.running)return;let e=await (0,c.RA)("/api/code/clearOutput",this.props.token,{...this.state.codeObj});(null==e?void 0:e.error)?alert(e.error):this.setState({output:null,codeObj:{...this.state.codeObj,properties:{...this.state.codeObj.properties,result:null}}},()=>{this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj)})},this.handleOnRunClick=async(e,t)=>{if(this.state.running)return;let i=this.isOwnCode();void 0===e&&(e=i),this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj,"runStart"),this.setState({output:"executing...",running:!0,success:null,codeVsConsoleSwitchValue:"console"});let s=p.A.clientValidation(this.state.codeObj),l=null;if("failed"===s.status)l={stdout:null,stderr:s.message};else{var n;this.props.handleRunStart&&this.props.handleRunStart(this.state.codeObj);let e=await (0,c.RA)("/api/code/exec",this.props.token||t,{...this.state.codeObj,visibility:this.props.visibility||this.state.codeObj.visibility||"public",parentURL:null===(n=this.props.preFill)||void 0===n?void 0:n.parentURL});l=e.error?{stdout:null,stderr:e.error}:e.json}let{success:a,output:r}=p.A.getResult(l);this.setState({success:a,output:r,running:!1,codeObj:{...this.state.codeObj,visibility:l.newVisibility||this.state.codeObj.visibility||"public",properties:{...this.state.codeObj.properties,result:{...this.state.codeObj.properties.result||{},success:a,output:r}}}},()=>{this.props.handleRunComplete&&this.props.handleRunComplete(this.state.codeObj,i)})},this.updateLanguage=async e=>{let t={...JSON.parse(JSON.stringify(d[e]))};if(this.props.preFill&&this.props.preFill.preloadCodeIds&&this.props.preFill.preloadCodeIds[e]){let i=this.props.preFill.preloadCodeIds[e],s=await fetch("/api/posts/".concat(i),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.props.userToken)}});if(200===s.status){let e=await s.json();(t=e)._id=null,t.user=null,!0===this.props.preFill.listenToEvents&&e&&e.properties&&e.properties.stdin&&window.postMessage({eventType:"populateStdinBack",stdin:e.properties.stdin||""},"*")}else console.log("Missing permissions to preload code! id:"+i)}else!0===this.props.preFill.listenToEvents&&window.postMessage({eventType:"populateStdinBack",stdin:""},"*");this.setState({codeTabIndex:0,codeObj:{...t,visibility:this.props.visibility||this.state.codeObj.visibility||"public"}},()=>{this.props.handleNewCodeClick&&this.props.handleNewCodeClick(e)})},this.toggleEditingModel=()=>{this.setState({editingModelOpen:!this.state.editingModelOpen})},this.handleUpdateCode=(e,t,i,s)=>{i||p.A.updateFileNamesAndContent(e,this.state.codeObj.properties.language);let l=e.length<=this.state.codeTabIndex?this.state.codeTabIndex-1:this.state.codeTabIndex;-1===l&&(l=0),s&&(l=e.length-1),this.setState({codeObj:{...this.state.codeObj,properties:{...this.state.codeObj.properties,files:e}},codeTabIndex:l},()=>{t||this.createCodeId(),this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj,"codeUpdate")})},this.handleUpdateCodeMeta=(e,t)=>{this.setState({codeObj:{...this.state.codeObj,[e]:t}},()=>{this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj)})},this.handleTagsUpdate=e=>{if(e){let t=e.split(",").map(e=>e.trim().toLowerCase());this.setState({codeObj:{...this.state.codeObj,tags:t}})}else this.setState({codeObj:{...this.state.codeObj,tags:[]}})},this.handleCodeVsConsoleSwitch=(e,t)=>{this.setState({codeVsConsoleSwitchValue:t})},this.handleEmbedEvent=this.handleEmbedEvent.bind(this);let s=this.props.preFill||{},l=s.language||"java",n=s.codeObj||{...JSON.parse(JSON.stringify(d[l])),language:l,visibility:this.props.visibility||"public"};if((null==n?void 0:null===(t=n.properties)||void 0===t?void 0:t.result)&&(null===(i=d[l])||void 0===i?void 0:i.languageType)!=="web"){let{success:e,output:t}=p.A.getResult(n.properties.result);n.properties.result={...n.properties.result,success:e,output:t}}this.state={language:l,codeObj:n,languageSelectionModelOpen:!1,imageUploadModelOpen:!1,output:null,running:!1,editingModelOpen:!1,creatingCodeId:!1,isServer:!0,codeTabIndex:0,editorSettingsModelOpen:!1,editorReadOnly:!1,codeVsConsoleSwitchValue:"code"}}}let eK=(0,o.Ng)(e=>({loggedInUserObj:e.user,token:e.user.token}),{})(eY)},70362:(e,t,i)=>{i.d(t,{A:()=>g});var s=i(74848),l=i(14953),n=i.n(l),a=i(96540),r=i(26646),o=i(2584),d=i.n(o),p=i(67776),c=i.n(p),h=i(94598);let u=n()(()=>i.e(2245).then(i.bind(i,92245)),{loadableGenerated:{webpack:()=>[92245]},ssr:!1}),g=e=>{let t=(0,h.M)(),[i,l]=(0,a.useState)(null),[n,o]=(0,a.useState)(null);return(0,a.useEffect)(()=>{l({code:t=>{var i,l;let n=Array.isArray(t.children)?null===(i=t.children[0])||void 0===i?void 0:i.trim():null===(l=t.children)||void 0===l?void 0:l.trim();return t.inline?(0,s.jsx)("code",{children:n}):(0,s.jsx)(u,{language:t.language||t.className,value:n,disableCopyPaste:e.disableCopyPaste})},a:e=>(0,s.jsx)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer nofollow",children:e.children})}),o((null==t?void 0:t.theme)==="dark"?"dark":"light")},[null==t?void 0:t.theme]),(0,s.jsx)(r.$,{className:"md-view oc-theme-".concat(n," ").concat(e.disableCopyPaste?"unselectable":""),remarkPlugins:[c(),d()],components:i||{},children:e.markdown||""})}},33650:(e,t,i)=>{i.d(t,{A:()=>r});var s=i(74848),l=i(79219),n=i(62373),a=i(46968);let r=e=>{let t="Public (Everyone)",i="Private (Only You)",r="Unlisted (People with the Link)";return e.channelType&&"org"===e.channelType&&(t="Public (Visible outside of org)",i="Private (Visible only for org members)",r="Unlisted (People outside org with the link)"),e.channelType&&"team"===e.channelType&&(t="Public (Visible outside of team)",i="Private (Visible only for team members)",r="Unlisted (People outside team with the link)"),(0,s.jsxs)(l.A,{variant:e.variant||"outlined",style:{minWidth:e.minWidth||"200"},children:[(0,s.jsx)(n.A,{htmlFor:"visibility-selector",children:"Visibility"}),(0,s.jsxs)(a.A,{native:!0,value:e.value,onChange:t=>{e.onChange(t.target.value)},label:"Visibility",inputProps:{name:"visibility",id:"visibility-selector"},children:[(0,s.jsx)("option",{value:"public",children:t}),(0,s.jsx)("option",{value:"private",children:i}),!e.channelType&&(0,s.jsx)("option",{value:"unlisted",children:r})]})]})}}}]);